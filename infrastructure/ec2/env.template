# ISMS Application Environment Variables Template
# Copy this file to .env and fill in the values
# Usage: cp env.template .env && nano .env

# =============================================================================
# Database Configuration
# =============================================================================
POSTGRES_USER=postgres
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD
POSTGRES_DB=isms_db

# =============================================================================
# Backend Configuration
# =============================================================================

# Node Environment
NODE_ENV=production

# Seed Scope: Controls what data is seeded
# - "system": seed essential system data only if missing (automatic)
# - "reference": seed catalog/reference data (first-run production)
# - "full": reference data + sample/demo data (development only)
# - "none": do nothing (subsequent deployments)
SEED_SCOPE=none

# =============================================================================
# Authentication Configuration (Azure AD)
# =============================================================================
# Azure AD Tenant ID
AUTH_TENANT_ID=your-tenant-id-here

# Azure AD Application (Client) ID
AUTH_CLIENT_ID=your-client-id-here

# Azure AD Client Secret (for backend API calls)
AUTH_CLIENT_SECRET=your-client-secret-here

# OAuth Redirect URI (must match Azure AD app registration)
# Example: https://trust.example.com
AUTH_REDIRECT_URI=https://your-domain.com

# Frontend URL for email links (defaults to AUTH_REDIRECT_URI if not set)
# This is the base URL used in email notifications (e.g., login links)
# Example: https://trust.example.com
FRONTEND_URL=https://your-domain.com

# Allowed email domain for user registration
AUTH_ALLOWED_EMAIL_DOMAIN=paythru.com

# =============================================================================
# CORS Configuration
# =============================================================================
# Comma-separated list of allowed origins or wildcard patterns
# Example: https://trust.example.com,https://trust.*.example.com
# Wildcard support: https://trust.*.example.com matches all subdomains
CORS_TRUST_CENTER_ORIGINS=https://your-domain.com,https://trust.*.your-domain.com

# =============================================================================
# Trust Centre Configuration
# =============================================================================
# JWT Secret for Trust Centre (minimum 32 characters)
# Generate: openssl rand -base64 32
TRUST_CENTER_JWT_SECRET=CHANGE_ME_GENERATE_STRONG_SECRET_32_CHARS_MIN

# JWT Expiry (default: 24h)
TRUST_CENTER_JWT_EXPIRY=24h

# Max file size for uploads in MB (default: 50)
TRUST_CENTER_MAX_FILE_SIZE_MB=50

# Download token expiry (default: 1h)
TRUST_CENTER_DOWNLOAD_TOKEN_EXPIRY=1h

# =============================================================================
# Microservice Configuration
# =============================================================================
# Internal service authentication token (shared secret)
# All services (backend, document-service, ai-service) must use the same token
# Generate: openssl rand -base64 32
INTERNAL_SERVICE_TOKEN=CHANGE_ME_GENERATE_STRONG_SECRET

# Service URLs (internal - use Docker service names)
DOCUMENT_SERVICE_URL=http://document-service:4001
AI_SERVICE_URL=http://ai-service:4002

# Service timeouts in milliseconds
DOCUMENT_SERVICE_TIMEOUT=30000
AI_SERVICE_TIMEOUT=10000

# =============================================================================
# Frontend Configuration (Build-time variables)
# =============================================================================
# Backend API URL (used at build time)
# IMPORTANT: Use the base domain WITHOUT /api - the frontend code adds /api automatically
# Example: https://trust.demo.paythru.com (NOT https://trust.demo.paythru.com/api)
VITE_API_URL=https://your-domain.com

# Frontend Auth Configuration (must match backend)
VITE_AUTH_TENANT_ID=your-tenant-id-here
VITE_AUTH_CLIENT_ID=your-client-id-here
VITE_AUTH_REDIRECT_URI=https://your-domain.com

# App version (optional)
VITE_APP_VERSION=1.0.0

# =============================================================================
# SharePoint Integration (Optional)
# =============================================================================
# SharePoint Site ID
# SHAREPOINT_SITE_ID=

# SharePoint Drive/Document Library ID
# SHAREPOINT_DRIVE_ID=

# =============================================================================
# Confluence Integration (Optional)
# =============================================================================
# Confluence Base URL (e.g., https://your-domain.atlassian.net)
# CONFLUENCE_BASE_URL=

# Confluence API Username
# CONFLUENCE_USERNAME=

# Confluence API Token
# CONFLUENCE_API_TOKEN=

# =============================================================================
# Azure App-Only Authentication (Optional)
# =============================================================================
# If set, these override AUTH_* variables for app-only authentication
# AZURE_APP_CLIENT_ID=
# AZURE_APP_CLIENT_SECRET=
# AZURE_TENANT_ID=

# =============================================================================
# LLM Configuration (Legacy - AI Service uses Ollama)
# =============================================================================
# LLM Provider (default: ollama)
LLM_PROVIDER=ollama

# Ollama Base URL (internal - use Docker service name)
LLM_BASE_URL=http://ollama:11434

# LLM Model (default: llama2)
LLM_MODEL=llama2

# Embedding Model (default: nomic-embed-text)
LLM_EMBEDDING_MODEL=nomic-embed-text

# Similarity threshold for AI suggestions (default: 70)
LLM_SIMILARITY_THRESHOLD=70

# =============================================================================
# Email Configuration (Microsoft Graph API)
# =============================================================================
# Email service uses Microsoft Graph API to send emails via your Azure AD app registration.
# Requires Mail.Send application permission to be granted in Azure AD.
#
# From Address (Required)
# Must be a mailbox (user or shared mailbox) in your Microsoft 365 tenant
# Example: trustcenter@paythru.com or noreply@paythru.com
EMAIL_FROM=trustcenter@paythru.com

# Note: SMTP configuration is no longer used. Email sending is handled via Microsoft Graph API
# using the Azure app credentials (AZURE_APP_CLIENT_ID, AZURE_APP_CLIENT_SECRET, AZURE_TENANT_ID)

# =============================================================================
# Security Notes
# =============================================================================
# 1. Never commit .env file to version control
# 2. Use strong, randomly generated passwords and secrets
# 3. For production, consider using AWS Secrets Manager or Parameter Store
# 4. Rotate secrets regularly
# 5. Restrict file permissions: chmod 600 .env

# =============================================================================
# AWS Secrets Manager Integration (Optional)
# =============================================================================
# To use AWS Secrets Manager instead of .env file:
# 1. Store secrets in AWS Secrets Manager
# 2. Use AWS CLI or SDK to retrieve secrets at runtime
# 3. Example: aws secretsmanager get-secret-value --secret-id isms-secrets
# 4. Update deployment scripts to load secrets from Secrets Manager



